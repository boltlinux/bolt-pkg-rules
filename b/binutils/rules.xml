<?xml version="1.0" encoding="utf-8"?>
<rules>

    <prepare>
    <![CDATA[

cd $BOLT_BUILD_DIR
$BOLT_SOURCE_DIR/configure  \
            --with-sysroot=/ \
            --enable-shared  \
            --enable-plugins \
            --prefix=/usr    \
            --disable-nls    \
            --disable-doc    \
            --with-system-zlib \
            --with-pkgversion="GNU Binutils for Bolt OS"

# make it skip the documentation
echo "MAKEINFO=:" >> $BOLT_BUILD_DIR/Makefile

    ]]>
    </prepare>

    <build>
    <![CDATA[

cd $BOLT_BUILD_DIR
make -j${BOLT_PARALLEL_JOBS}

    ]]>
    </build>

    <install>
    <![CDATA[

cd $BOLT_BUILD_DIR
make DESTDIR=$BOLT_INSTALL_DIR install

# turn hardlink into symbolic link
rm $BOLT_INSTALL_DIR/usr/bin/ld
ln -s ld.bfd $BOLT_INSTALL_DIR/usr/bin/ld

# copy additional header files
for i in demangle.h libiberty.h; do
  install -m 644 $BOLT_SOURCE_DIR/include/$i $BOLT_INSTALL_DIR/usr/include
done

    ]]>
    </install>

</rules>
