<?xml version="1.0" encoding="utf-8"?>
<rules>
    <prepare>
    <![CDATA[

true

    ]]>
    </prepare>

    <build>
    <![CDATA[

cd "$BOLT_BUILD_DIR"

# Verify root-anchors.xml using OpenSSL
openssl smime -verify -noverify -inform DER -in root-anchors.p7s -content root-anchors.xml

# Verify root.hints
gpgv --keyring ./registry-admin.key ./root.hints.sig ./root.hints

# Create key from validated root-anchors.xml
./parse-root-anchors.sh < root-anchors.xml | sort -k 4 -n > root-anchors.ds

# Create key from downloaded root.key
/usr/bin/ldns-key2ds -n -2 root.key | cut --fields=1,3- --output-delimiter=' ' | sort -k 4 -n > root.ds

# Compare the DS from root.key and from root-anchors.xml
diff -u root-anchors.ds root.ds

    ]]>
    </build>

    <install>
    <![CDATA[

cd "$BOLT_BUILD_DIR"

install -d 0755 "$BOLT_INSTALL_DIR/usr/share/dns/"
cp root.* "$BOLT_INSTALL_DIR/usr/share/dns/"

    ]]>
    </install>
</rules>
